<!-- MODAL: Tổng hợp nhôm nguyên cây -->
<div id="aluminumSummaryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h2 class="text-2xl font-bold">Tổng hợp nhôm nguyên cây</h2>
            <button onclick="closeAluminumSummaryModal()" class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="p-6">
            <!-- Summary Cards -->
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                    <div class="text-sm text-blue-600 mb-1">Tổng chiều dài</div>
                    <div class="text-2xl font-bold text-blue-900" id="aluminumTotalLength">0</div>
                    <div class="text-xs text-blue-600">mét</div>
                </div>
                <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                    <div class="text-sm text-green-600 mb-1">Tổng trọng lượng</div>
                    <div class="text-2xl font-bold text-green-900" id="aluminumTotalWeight">0</div>
                    <div class="text-xs text-green-600">kg</div>
                </div>
                <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                    <div class="text-sm text-purple-600 mb-1">Số thanh cần</div>
                    <div class="text-2xl font-bold text-purple-900" id="aluminumTotalBars">0</div>
                    <div class="text-xs text-purple-600">thanh</div>
                </div>
                <div class="bg-orange-50 rounded-lg p-4 border border-orange-200">
                    <div class="text-sm text-orange-600 mb-1">Tổng giá trị</div>
                    <div class="text-2xl font-bold text-orange-900" id="aluminumTotalPrice">0</div>
                    <div class="text-xs text-orange-600">VNĐ</div>
                </div>
            </div>

            <!-- Table -->
            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-2 text-left">Tên thanh nhôm</th>
                            <th class="border border-gray-300 px-4 py-2 text-left">Ký hiệu</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Chiều dài (m)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Trọng lượng (kg)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Số lượng</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Đơn giá (VNĐ/kg)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Thành tiền</th>
                        </tr>
                    </thead>
                    <tbody id="aluminumTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Actions -->
            <div class="flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200">
                <button onclick="exportAluminumSummary()" class="px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600">
                    Xuất Excel
                </button>
                <button onclick="closeAluminumSummaryModal()" class="px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                    Đóng
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL: Tổng hợp kính -->
<div id="glassSummaryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h2 class="text-2xl font-bold">Tổng hợp kính</h2>
            <button onclick="closeGlassSummaryModal()" class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="p-6">
            <!-- Summary Cards -->
            <div class="grid grid-cols-3 gap-4 mb-6">
                <div class="bg-cyan-50 rounded-lg p-4 border border-cyan-200">
                    <div class="text-sm text-cyan-600 mb-1">Tổng diện tích</div>
                    <div class="text-2xl font-bold text-cyan-900" id="glassTotalArea">0</div>
                    <div class="text-xs text-cyan-600">m²</div>
                </div>
                <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                    <div class="text-sm text-blue-600 mb-1">Số tấm kính</div>
                    <div class="text-2xl font-bold text-blue-900" id="glassTotalPieces">0</div>
                    <div class="text-xs text-blue-600">tấm</div>
                </div>
                <div class="bg-orange-50 rounded-lg p-4 border border-orange-200">
                    <div class="text-sm text-orange-600 mb-1">Tổng giá trị</div>
                    <div class="text-2xl font-bold text-orange-900" id="glassTotalPrice">0</div>
                    <div class="text-xs text-orange-600">VNĐ</div>
                </div>
            </div>

            <!-- Table -->
            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-2 text-left">Mã cửa</th>
                            <th class="border border-gray-300 px-4 py-2 text-left">Loại kính</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Rộng (mm)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Cao (mm)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Diện tích (m²)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Số lượng</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Đơn giá (VNĐ/m²)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Thành tiền</th>
                        </tr>
                    </thead>
                    <tbody id="glassTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Actions -->
            <div class="flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200">
                <button onclick="exportGlassSummary()" class="px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600">
                    Xuất Excel
                </button>
                <button onclick="closeGlassSummaryModal()" class="px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                    Đóng
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL: Tổng hợp phụ kiện, Gioăng, keo -->
<div id="accessoriesSummaryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h2 class="text-2xl font-bold">Tổng hợp phụ kiện, Gioăng, keo</h2>
            <button onclick="closeAccessoriesSummaryModal()" class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="p-6">
            <!-- Tabs -->
            <div class="flex gap-2 mb-6 border-b border-gray-200">
                <button onclick="switchAccessoriesTab('accessories', this)" class="px-4 py-2 font-medium border-b-2 border-blue-500 text-blue-600">
                    Phụ kiện
                </button>
                <button onclick="switchAccessoriesTab('gaskets', this)" class="px-4 py-2 font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900">
                    Gioăng
                </button>
                <button onclick="switchAccessoriesTab('glue', this)" class="px-4 py-2 font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900">
                    Keo
                </button>
            </div>

            <!-- Summary Card -->
            <div class="bg-purple-50 rounded-lg p-4 border border-purple-200 mb-6">
                <div class="text-sm text-purple-600 mb-1">Tổng giá trị</div>
                <div class="text-3xl font-bold text-purple-900" id="accessoriesTotalPrice">0</div>
                <div class="text-xs text-purple-600">VNĐ</div>
            </div>

            <!-- Phụ kiện Tab -->
            <div id="accessoriesTab" class="tab-content">
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="border border-gray-300 px-4 py-2 text-left">Tên phụ kiện</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Mã</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Số lượng</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Đơn vị</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Đơn giá</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Thành tiền</th>
                            </tr>
                        </thead>
                        <tbody id="accessoriesTableBody">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Gioăng Tab -->
            <div id="gasketsTab" class="tab-content hidden">
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="border border-gray-300 px-4 py-2 text-left">Tên gioăng</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Mã</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Chiều dài (m)</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Đơn giá (VNĐ/m)</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Thành tiền</th>
                            </tr>
                        </thead>
                        <tbody id="gasketsTableBody">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Keo Tab -->
            <div id="glueTab" class="tab-content hidden">
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="border border-gray-300 px-4 py-2 text-left">Tên keo</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Mã</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Chiều dài (m)</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Đơn giá (VNĐ/m)</th>
                                <th class="border border-gray-300 px-4 py-2 text-right">Thành tiền</th>
                            </tr>
                        </thead>
                        <tbody id="glueTableBody">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200">
                <button onclick="exportAccessoriesSummary()" class="px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600">
                    Xuất Excel
                </button>
                <button onclick="closeAccessoriesSummaryModal()" class="px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                    Đóng
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL: Bảng báo giá -->
<div id="quotationModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h2 class="text-2xl font-bold">Bảng báo giá</h2>
            <button onclick="closeQuotationModal()" class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="p-6">
            <!-- Summary Card -->
            <div class="bg-green-50 rounded-lg p-4 border border-green-200 mb-6">
                <div class="text-sm text-green-600 mb-1">Tổng giá trị báo giá</div>
                <div class="text-3xl font-bold text-green-900" id="quotationTotalAmount">0</div>
                <div class="text-xs text-green-600">VNĐ</div>
            </div>

            <!-- Table -->
            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-4 py-2 text-left">Mã cửa</th>
                            <th class="border border-gray-300 px-4 py-2 text-left">Tên cửa</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Giá vốn</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Lợi nhuận (%)</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Giá bán</th>
                            <th class="border border-gray-300 px-4 py-2 text-right">Thành tiền</th>
                        </tr>
                    </thead>
                    <tbody id="quotationTableBody">
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Actions -->
            <div class="flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200">
                <button onclick="exportQuotation()" class="px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600">
                    Xuất PDF
                </button>
                <button onclick="closeQuotationModal()" class="px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                    Đóng
                </button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL: Tài chính công trình -->
<div id="projectFinanceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
            <h2 class="text-2xl font-bold">Tài chính công trình</h2>
            <button onclick="closeProjectFinanceModal()" class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div class="p-6">
            <!-- Summary Cards -->
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                    <div class="text-sm text-green-600 mb-1">Doanh thu</div>
                    <div class="text-2xl font-bold text-green-900" id="financeRevenue">0</div>
                    <div class="text-xs text-green-600">VNĐ</div>
                </div>
                <div class="bg-red-50 rounded-lg p-4 border border-red-200">
                    <div class="text-sm text-red-600 mb-1">Chi phí</div>
                    <div class="text-2xl font-bold text-red-900" id="financeCost">0</div>
                    <div class="text-xs text-red-600">VNĐ</div>
                </div>
                <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                    <div class="text-sm text-blue-600 mb-1">Lợi nhuận</div>
                    <div class="text-2xl font-bold text-blue-900" id="financeProfit">0</div>
                    <div class="text-xs text-blue-600">VNĐ</div>
                </div>
                <div class="bg-orange-50 rounded-lg p-4 border border-orange-200">
                    <div class="text-sm text-orange-600 mb-1">Công nợ</div>
                    <div class="text-2xl font-bold text-orange-900" id="financeDebt">0</div>
                    <div class="text-xs text-orange-600">VNĐ</div>
                </div>
            </div>

            <!-- Chi tiết -->
            <div class="space-y-6">
                <!-- Doanh thu -->
                <div>
                    <h3 class="text-lg font-semibold mb-3">Doanh thu</h3>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-sm text-gray-600">Doanh thu từ báo giá</label>
                                <div class="text-xl font-bold" id="financeRevenueFromQuotation">0 VNĐ</div>
                            </div>
                            <div>
                                <label class="text-sm text-gray-600">Doanh thu khác</label>
                                <div class="text-xl font-bold" id="financeRevenueOther">0 VNĐ</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chi phí -->
                <div>
                    <h3 class="text-lg font-semibold mb-3">Chi phí</h3>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label class="text-sm text-gray-600">Chi phí nhôm</label>
                                <div class="text-lg font-bold" id="financeCostAluminum">0 VNĐ</div>
                            </div>
                            <div>
                                <label class="text-sm text-gray-600">Chi phí kính</label>
                                <div class="text-lg font-bold" id="financeCostGlass">0 VNĐ</div>
                            </div>
                            <div>
                                <label class="text-sm text-gray-600">Chi phí phụ kiện</label>
                                <div class="text-lg font-bold" id="financeCostAccessories">0 VNĐ</div>
                            </div>
                            <div>
                                <label class="text-sm text-gray-600">Chi phí nhân công</label>
                                <div class="text-lg font-bold" id="financeCostLabor">0 VNĐ</div>
                            </div>
                            <div>
                                <label class="text-sm text-gray-600">Chi phí khác</label>
                                <div class="text-lg font-bold" id="financeCostOther">0 VNĐ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200">
                <button onclick="exportFinanceSummary()" class="px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600">
                    Xuất Excel
                </button>
                <button onclick="closeProjectFinanceModal()" class="px-6 py-2 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50">
                    Đóng
                </button>
            </div>
        </div>
    </div>
</div>






